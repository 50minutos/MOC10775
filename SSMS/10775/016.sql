USE MASTER

EXEC SP_MSFOREACHDB 'DBCC CHECKDB(?)'

ALTER DATABASE DB
SET SINGLE_USER
WITH ROLLBACK IMMEDIATE

DBCC CHECKDB(DB, REPAIR_ALLOW_DATA_LOSS)

ALTER DATABASE DB
SET MULTI_USER

USE DB

EXEC SP_TABLES

SELECT *
FROM SYS.dm_db_index_physical_stats(DB_ID(), OBJECT_ID('PRODUCAO.PRODUTO'), -1, 0, NULL )

ALTER INDEX ALL 
ON PRODUCAO.PRODUTO
REBUILD

GO

CREATE PROC USP_SOMAR
	@X INT = 1, 
	@Y INT = 2
AS
	SELECT @X + @Y 'SOMA'
GO

EXEC USP_SOMAR 

EXEC USP_SOMAR @Y = 12

EXEC USP_SOMAR 120, 13

GO

CREATE FUNCTION UDF_SOMAR
(
	@X INT = 1, 
	@Y INT = 2, 
	@Z VARCHAR(50) = NULL
)
RETURNS INT
AS
BEGIN
	RETURN @X + @Y
END
GO

SELECT DBO.UDF_SOMAR(12, 14314, NULL)

SELECT DBO.UDF_SOMAR(NULL, NULL, NULL)

SELECT DBO.UDF_SOMAR(1, 2, NULL)

EXEC SP_UPDATESTATS

--CRIAR PLANO DE MANUTENÇÃO DO DB

